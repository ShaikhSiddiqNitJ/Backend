graph TB
    Start([Client/User]) --> API{API Request}
    
    %% GET All Products Flow
    API -->|GET /api/products| GetAll[GET All Products]
    GetAll --> CheckCache1{Check Redis Cache<br/>Key: products::SimpleKey}
    CheckCache1 -->|Cache HIT âœ…| ReturnCache1[Return from Redis<br/>âš¡ FAST Response]
    CheckCache1 -->|Cache MISS âŒ| FetchDB1[Fetch from PostgreSQL<br/>SELECT * FROM products]
    FetchDB1 --> StoreCache1[Store in Redis<br/>TTL: 10 minutes]
    StoreCache1 --> ReturnDB1[Return to Client]
    ReturnCache1 --> End1([Response Sent])
    ReturnDB1 --> End1
    
    %% GET Product by ID Flow
    API -->|GET /api/products/1| GetById[GET Product by ID]
    GetById --> CheckCache2{Check Redis Cache<br/>Key: products::1}
    CheckCache2 -->|Cache HIT âœ…| ReturnCache2[Return from Redis<br/>âš¡ FAST Response]
    CheckCache2 -->|Cache MISS âŒ| FetchDB2[Fetch from PostgreSQL<br/>SELECT * FROM products<br/>WHERE id = 1]
    FetchDB2 --> StoreCache2[Store in Redis<br/>Key: products::1<br/>TTL: 10 minutes]
    StoreCache2 --> ReturnDB2[Return to Client]
    ReturnCache2 --> End2([Response Sent])
    ReturnDB2 --> End2
    
    %% POST Create Product Flow
    API -->|POST /api/products| Create[Create New Product]
    Create --> SaveDB[Save to PostgreSQL<br/>INSERT INTO products]
    SaveDB --> UpdateCache1[Update Redis Cache<br/>Key: products::new_id]
    UpdateCache1 --> End3([Product Created])
    
    %% PUT Update Product Flow
    API -->|PUT /api/products/1| Update[Update Product]
    Update --> UpdateDB[Update PostgreSQL<br/>UPDATE products<br/>WHERE id = 1]
    UpdateDB --> UpdateCache2[Update Redis Cache<br/>Key: products::1]
    UpdateCache2 --> End4([Product Updated])
    
    %% DELETE Product Flow
    API -->|DELETE /api/products/1| Delete[Delete Product]
    Delete --> DeleteDB[Delete from PostgreSQL<br/>DELETE FROM products<br/>WHERE id = 1]
    DeleteDB --> EvictCache[Remove from Redis<br/>Key: products::1]
    EvictCache --> End5([Product Deleted])
    
    %% Clear Cache Flow
    API -->|DELETE /api/products/cache/clear| ClearCache[Clear All Cache]
    ClearCache --> ClearRedis[Clear All Redis Keys<br/>FLUSHDB products]
    ClearRedis --> End6([Cache Cleared])
    
    %% Database Storage Example
    subgraph PostgreSQL["ğŸ—„ï¸ PostgreSQL Database"]
        DBTable["products table<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>id | name | description | price | quantity<br/>1 | Laptop | Gaming Laptop | 1200.0 | 10<br/>2 | Product 1 | Description 1 | 110.0 | 11<br/>3 | Product 2 | Description 2 | 120.0 | 12<br/>... (101 rows total)"]
    end
    
    %% Redis Cache Storage Example
    subgraph Redis["âš¡ Redis Cache (In-Memory)"]
        RedisKeys["Cached Keys:<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>1ï¸âƒ£ products::SimpleKey<br/>   â†’ All Products List (101 items)<br/>   â†’ Size: 16 KB<br/>   â†’ TTL: 600 seconds<br/><br/>2ï¸âƒ£ products::1<br/>   â†’ Single Product (id=1)<br/>   â†’ Data: id:1, name:Laptop, price:1200<br/>   â†’ TTL: 600 seconds<br/><br/>3ï¸âƒ£ products::2<br/>   â†’ Single Product (id=2)<br/>   â†’ TTL: 600 seconds"]
    end
    
    %% Performance Comparison
    subgraph Performance["ğŸ“Š Performance Comparison"]
        Perf["Database Query: ~50-100ms ğŸ¢<br/>Redis Cache: ~1-5ms âš¡<br/>Speed Improvement: 10-50x faster!"]
    end
    
    %% Cache Strategy
    subgraph CacheStrategy["ğŸ¯ Caching Strategy"]
        Strategy["@Cacheable â†’ Read from cache<br/>@CachePut â†’ Update cache<br/>@CacheEvict â†’ Remove from cache<br/>TTL: 10 minutes (auto-expire)"]
    end
    
    style Start fill:#e1f5ff
    style End1 fill:#c8e6c9
    style End2 fill:#c8e6c9
    style End3 fill:#c8e6c9
    style End4 fill:#c8e6c9
    style End5 fill:#c8e6c9
    style End6 fill:#c8e6c9
    style CheckCache1 fill:#fff9c4
    style CheckCache2 fill:#fff9c4
    style ReturnCache1 fill:#a5d6a7
    style ReturnCache2 fill:#a5d6a7
    style FetchDB1 fill:#ffccbc
    style FetchDB2 fill:#ffccbc
    style PostgreSQL fill:#e3f2fd
    style Redis fill:#fff3e0
    style Performance fill:#f3e5f5
    style CacheStrategy fill:#e8f5e9
